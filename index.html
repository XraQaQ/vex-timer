<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>VEX Timer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <style>
    body {
      margin: 0;
      background: radial-gradient(circle at top, #141a28, #05070d);
      font-family: Inter, Arial, sans-serif;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    .card {
      background: linear-gradient(180deg, #111827, #0b1020);
      border-radius: 18px;
      width: 520px;
      padding: 26px 28px 30px;
      box-shadow: 0 30px 80px rgba(0,0,0,.6);
    }

    .top {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .title {
      font-weight: 800;
      letter-spacing: .5px;
      font-size: 20px;
    }

    .lang-btn {
      border: none;
      background: #1f2937;
      color: #fff;
      padding: 6px 14px;
      border-radius: 999px;
      cursor: pointer;
      font-weight: 700;
    }

    .time {
      text-align: center;
      font-size: 72px;
      font-weight: 900;
      margin: 28px 0;
    }

    .row {
      display: flex;
      gap: 12px;
      margin-bottom: 12px;
    }

    button {
      flex: 1;
      border: none;
      border-radius: 10px;
      padding: 14px 0;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
    }

    .primary {
      background: #e11d1d;
      color: #fff;
    }

    .secondary {
      background: #1f2937;
      color: #e5e7eb;
    }

    .small {
      padding: 10px 0;
      font-size: 14px;
    }

    input {
      flex: 1;
      padding: 12px;
      border-radius: 10px;
      border: none;
      background: #0f172a;
      color: #fff;
      font-size: 14px;
    }

    .rule {
      margin-top: 14px;
      font-size: 12px;
      opacity: .65;
    }
  </style>
</head>

<body>
  <div class="card">
    <div class="top">
      <div class="title" id="title">VEX TIMER</div>
      <button class="lang-btn" id="langBtn">中</button>
    </div>

    <div class="time" id="time">0:00</div>

    <div class="row">
      <button class="primary" id="btnSkills"></button>
      <button class="primary" id="btnDriver"></button>
    </div>

    <div class="row">
      <button class="secondary small" id="btnAuto15"></button>
      <button class="secondary small" id="btnReset"></button>
    </div>

    <div class="row">
      <input id="customInput" placeholder="">
      <button class="primary small" id="btnCustom"></button>
    </div>

    <div class="row">
      <button class="secondary small" id="btnPause"></button>
      <button class="secondary small" id="btnResume"></button>
    </div>

    <div class="rule" id="ruleText"></div>
  </div>

<script>
/* ---------- Language ---------- */
let lang = "en";

const TEXT = {
  en: {
    title: "VEX TIMER",
    skills: "Skills",
    driver: "Driver",
    auto15: "15s Auto",
    reset: "Reset",
    custom: "Custom Start",
    pause: "Pause",
    resume: "Resume",
    input: "Custom seconds (e.g. 120)",
    rule: "Rule: >30s every 10s · 30–15 every 5s · last 15s countdown"
  },
  zh: {
    title: "VEX 计时器",
    skills: "技能赛",
    driver: "手动赛",
    auto15: "15秒自动",
    reset: "重置",
    custom: "自定义开始",
    pause: "暂停",
    resume: "继续",
    input: "自定义秒数（如 120）",
    rule: "规则：30秒前每10秒，30–15每5秒，15秒倒数"
  }
};

function renderLang() {
  const t = TEXT[lang];
  title.textContent = t.title;
  btnSkills.textContent = t.skills;
  btnDriver.textContent = t.driver;
  btnAuto15.textContent = t.auto15;
  btnReset.textContent = t.reset;
  btnCustom.textContent = t.custom;
  btnPause.textContent = t.pause;
  btnResume.textContent = t.resume;
  customInput.placeholder = t.input;
  ruleText.textContent = t.rule;
  langBtn.textContent = lang === "en" ? "中" : "EN";
}

langBtn.onclick = () => {
  lang = lang === "en" ? "zh" : "en";
  renderLang();
};

renderLang();

/* ---------- Timer ---------- */
let timer = null;
let remaining = 0;
let paused = false;

function speak(text) {
  const u = new SpeechSynthesisUtterance(text);
  u.lang = lang === "zh" ? "zh-CN" : "en-US";
  speechSynthesis.speak(u);
}

function update() {
  time.textContent =
    Math.floor(remaining / 60) + ":" +
    (remaining % 60).toString().padStart(2, "0");
}

function clearTimer() {
  clearInterval(timer);
  timer = null;
}

function start(seconds) {
  clearTimer();
  paused = false;
  remaining = 3;
  update();
  speak("3");

  timer = setInterval(() => {
    remaining--;
    update();
    if (remaining === 2) speak("2");
    if (remaining === 1) speak("1");

    if (remaining <= 0) {
      clearTimer();
      remaining = seconds;
      update();
      speak(seconds.toString());

      timer = setInterval(tick, 1000);
    }
  }, 1000);
}

function tick() {
  if (paused) return;
  remaining--;
  update();

  if (remaining > 30 && remaining % 10 === 0) speak(remaining.toString());
  else if (remaining <= 30 && remaining > 15 && remaining % 5 === 0) speak(remaining.toString());
  else if (remaining <= 15 && remaining > 0) speak(remaining.toString());

  if (remaining <= 0) {
    clearTimer();
    speak(lang === "zh" ? "结束" : "End");
  }
}

/* ---------- Buttons ---------- */
btnSkills.onclick = () => start(60);
btnDriver.onclick = () => start(105);
btnAuto15.onclick = () => start(15);
btnReset.onclick = () => { clearTimer(); remaining = 0; update(); };
btnPause.onclick = () => paused = true;
btnResume.onclick = () => paused = false;
btnCustom.onclick = () => {
  const v = parseInt(customInput.value);
  if (!isNaN(v) && v > 0) start(v);
};
</script>
</body>
</html>
