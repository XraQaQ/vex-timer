<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>VEX Timer</title>

<style>
:root{
  --bg:#0a0d12;
  --panel:#121826cc;
  --panel-solid:#121826;
  --text:#f1f5ff;
  --muted:#9aa7c7;
  --vex-red:#e11919;
  --vex-red-soft:#e1191944;
  --border:rgba(255,255,255,.08);
  --radius:20px;
}

*{box-sizing:border-box}

body{
  margin:0;
  min-height:100vh;
  background:
    radial-gradient(900px 500px at 20% 10%, #e1191922, transparent 60%),
    radial-gradient(700px 400px at 80% 20%, #e119191a, transparent 60%),
    linear-gradient(180deg,#05070b,var(--bg));
  font-family:system-ui,-apple-system,BlinkMacSystemFont;
  color:var(--text);
  display:flex;
  align-items:center;
  justify-content:center;
}

.container{
  width:min(1000px,96%);
  backdrop-filter: blur(14px);
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:28px 28px 30px;
}

/* ===== Header ===== */
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:18px;
}

.brand{
  display:flex;
  align-items:center;
  gap:14px;
}
.logo{
  width:42px;height:42px;
  border-radius:12px;
  background:linear-gradient(135deg,var(--vex-red),#ff3b3b);
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:900;
  font-size:20px;
}
.brand h1{
  margin:0;
  font-size:18px;
  letter-spacing:.15em;
}

.langbtn{
  background:#0f1422;
  border:1px solid var(--border);
  border-radius:999px;
  padding:8px 16px;
  font-weight:700;
  color:var(--text);
  cursor:pointer;
}

/* ===== Time ===== */
.time-wrap{
  margin:22px 0 26px;
  padding:30px 10px;
  border-radius:24px;
  background:
    linear-gradient(180deg,#00000055,#00000022),
    var(--panel-solid);
  border:2px solid var(--vex-red-soft);
  text-align:center;
}

#time{
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
  font-size: clamp(96px, 12vw, 140px);
  font-weight:900;
  letter-spacing:.06em;
}

/* ===== Buttons ===== */
.grid{
  display:grid;
  gap:14px;
}

.grid.modes{
  grid-template-columns:repeat(3,1fr);
}

.grid.controls{
  grid-template-columns:repeat(2,1fr);
}

button,input{
  font-size:17px;
  padding:14px 18px;
  border-radius:16px;
  border:1px solid var(--border);
  background:#0f1422;
  color:var(--text);
}

button{
  cursor:pointer;
  font-weight:800;
}

button.primary{
  background:linear-gradient(135deg,var(--vex-red),#ff3b3b);
  border:none;
}

button.ghost{
  background:#0c1020;
}

button:disabled{opacity:.45}

/* ===== Custom ===== */
.custom{
  margin-top:18px;
  display:flex;
  gap:12px;
}

input{
  flex:1;
}

/* ===== Footer text ===== */
.rule{
  margin-top:14px;
  font-size:13px;
  color:var(--muted);
  text-align:center;
}
</style>
</head>

<body>
<div class="container">
  <div class="header">
    <div class="brand">
      <div class="logo">V</div>
      <h1>VEX TIMER</h1>
    </div>
    <button class="langbtn" onclick="toggleLang()">中文 / EN</button>
  </div>

  <div class="time-wrap">
    <div id="time">0:00</div>
  </div>

  <div class="grid modes">
    <button class="primary" onclick="modeSkills()" id="btnSkills">Skills</button>
    <button onclick="modeAuto15()" id="btnAuto15">15秒自动</button>
    <button class="primary" onclick="modeDriver()" id="btnDriver">Driver</button>
  </div>

  <div class="grid controls" style="margin-top:14px">
    <button onclick="pauseTimer()" id="pauseBtn" disabled>暂停</button>
    <button onclick="resumeTimer()" id="resumeBtn" disabled>继续</button>
  </div>

  <div class="custom">
    <input id="customInput" type="number" min="1" placeholder="自定义秒数">
    <button onclick="startCustom()" id="btnCustom">开始自定义</button>
    <button class="ghost" onclick="resetAll()" id="btnReset">重置</button>
  </div>

  <div class="rule" id="ruleText">
    固定报时规则：＞30 秒每 10 秒 ｜ 30–15 秒每 5 秒 ｜ ≤15 秒逐秒
  </div>
</div>

<script>
/* ===== 语言系统（保持）===== */
let lang = localStorage.getItem("vex_lang") || "zh";
const I18N={
  zh:{
    skills:"Skills",auto15:"15秒自动",driver:"Driver",reset:"重置",
    pause:"暂停",resume:"继续",custom:"开始自定义",
    rule:"固定报时规则：＞30 秒每 10 秒 ｜ 30–15 秒每 5 秒 ｜ ≤15 秒逐秒",
    start60:"60秒",start145:"1分45秒",end:"结束",
    sec:n=>`${n}秒`,num:n=>`${n}`,tts:"zh-CN"
  },
  en:{
    skills:"Skills",auto15:"Auto 15s",driver:"Driver",reset:"Reset",
    pause:"Pause",resume:"Resume",custom:"Start Custom",
    rule:"Fixed rules: >30s every 10s | 30–15s every 5s | ≤15s countdown",
    start60:"60 seconds",start145:"1 minute 45 seconds",end:"End",
    sec:n=>`${n} seconds`,num:n=>`${n}`,tts:"en-US"
  }
};
function applyLang(){
  const L=I18N[lang];
  btnSkills.innerText=L.skills;
  btnAuto15.innerText=L.auto15;
  btnDriver.innerText=L.driver;
  btnReset.innerText=L.reset;
  pauseBtn.innerText=L.pause;
  resumeBtn.innerText=L.resume;
  btnCustom.innerText=L.custom;
  ruleText.innerText=L.rule;
}
function toggleLang(){
  lang=lang==="zh"?"en":"zh";
  localStorage.setItem("vex_lang",lang);
  applyLang();
}

/* ===== 计时逻辑（不变）===== */
let timer=null,remaining=0,paused=false,resumeHandler=null;
function speak(t){
  const u=new SpeechSynthesisUtterance(t);
  u.lang=I18N[lang].tts;
  speechSynthesis.speak(u);
}
function update(){
  const m=Math.floor(remaining/60),s=remaining%60;
  time.innerText=`${m}:${s.toString().padStart(2,"0")}`;
}
function clearTimer(){if(timer){clearInterval(timer);timer=null}}
function setPause(p,r){pauseBtn.disabled=!p;resumeBtn.disabled=!r}

function fixedAnnounce(){
  const L=I18N[lang];
  if(remaining>30 && remaining%10===0)speak(L.sec(remaining));
  else if(remaining<=30 && remaining>15 && remaining%5===0)speak(L.sec(remaining));
  else if(remaining<=15 && remaining>0)speak(L.num(remaining));
}

function startWith321(sec,txt){
  resetAll();remaining=3;update();speak("3");
  resumeHandler=function(){
    remaining--;update();
    if(remaining===2)speak("2");
    if(remaining===1)speak("1");
    if(remaining<=0){
      clearTimer();remaining=sec;update();speak(txt);
      resumeHandler=runTick;
      timer=setInterval(resumeHandler,1000);
      setPause(true,false);
    }
  };
  timer=setInterval(resumeHandler,1000);
  setPause(true,false);
}
function runTick(){
  remaining--;update();fixedAnnounce();
  if(remaining<=0){clearTimer();speak(I18N[lang].end);setPause(false,false)}
}

function modeSkills(){startWith321(60,I18N[lang].start60)}
function modeDriver(){startWith321(105,I18N[lang].start145)}
function modeAuto15(){startWith321(15,I18N[lang].sec(15))}
function startCustom(){
  const v=parseInt(customInput.value);
  if(v>0)startWith321(v,I18N[lang].sec(v));
}
function pauseTimer(){if(timer){clearTimer();paused=true;setPause(false,true)}}
function resumeTimer(){if(paused){paused=false;timer=setInterval(resumeHandler,1000);setPause(true,false)}}
function resetAll(){
  clearTimer();paused=false;remaining=0;update();
  setPause(false,false);speechSynthesis.cancel();
}

applyLang();
</script>
</body>
</html>
